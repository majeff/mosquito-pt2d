[AI_DETECTION]
# AI 檢測參數

# 輸入影像解析度（像素）
# - 320: 快速推理，適合低效能設備（約 15-25 FPS on Orange Pi 5）
# - 416: 平衡選項，中等精度與速度
# - 640: 標準精度，推薦使用（約 10-15 FPS on Orange Pi 5）
# - 800/1280: 高精度，適合 PC 開發環境
# 範圍: 320-1280，建議值: 640
imgsz = 640

# 信心度閾值（0.0-1.0）
# 只有信心度超過此閾值的檢測結果會被接受
# 範圍: 0.0-1.0，建議值: 0.4
confidence_threshold = 0.4

# IoU 閾值（Non-Maximum Suppression）
# 用於非極大值抑制，去除重複檢測框
# 範圍: 0.0-1.0，建議值: 0.45
iou_threshold = 0.45

# 偵測模式（預設使用平鋪推理以保留高解析度細節）
# 可選值：'tiling'（平鋪，建議預設）或 'whole'（整張影像）
# tiling: 將影像分割成小塊進行檢測，適合高解析度影像
# whole: 將整張影像縮放到指定大小後檢測，速度較快但精度可能較低
detection_mode = tiling

# 平鋪重疊比例（0.0-0.5 建議範圍），避免邊界漏檢
# 例如 0.25 代表平鋪視窗彼此重疊 25% 邊長
# 範圍: 0.0-0.5，建議值: 0.25
tile_overlap = 0.25

# 檢測邊界邊距（0.0-0.5，比例）
# 排除畫面邊緣區域的檢測結果，避免邊界誤檢
# 例如 0.1 代表排除上下左右各 10% 的邊界區域
# 範圍: 0.0-0.5，建議值: 0.0
detection_margin = 0.0

# 蚊子實際尺寸範圍（毫米）
# 透過雙目深度估計計算物件實際大小，過濾不在合理範圍內的檢測
# 參考：一般蚊子體長約 3-10 毫米
# 範圍: 1-50，建議值: 3-15
min_mosquito_size_mm = 3
max_mosquito_size_mm = 15

[SINGLE_CAMERA_FILTER]
# 單目過濾器參數（無深度資訊時使用）

# 是否啟用檢測框大小過濾
enable_bbox_size_filter = true

# 最小檢測框邊長（像素），範圍: 1-200，建議值: 10
min_bbox_size_px = 10

# 最大檢測框邊長（像素），範圍: 10-1000，建議值: 200
max_bbox_size_px = 200

# 是否啟用寬高比過濾
enable_aspect_ratio_filter = true

# 最小寬高比（寬/高），範圍: 0.1-10.0，建議值: 0.3
min_aspect_ratio = 0.3

# 最大寬高比（寬/高），範圍: 0.1-10.0，建議值: 3.0
max_aspect_ratio = 3.0

# 是否啟用時間連續性過濾
enable_temporal_filter = true

# 最少連續出現幀數（才算有效目標），範圍: 1-30，建議值: 3
min_consecutive_frames = 3

# 是否啟用運動合理性過濾
enable_motion_filter = true

# 最大每幀移動距離（像素），範圍: 10-500，建議值: 150
max_movement_px_per_frame = 150

# 最大靜止幀數（超過視為靜物），範圍: 10-300，建議值: 60
max_static_frames = 60

# 靜止判定閾值（像素），範圍: 1-50，建議值: 5
static_threshold_px = 5

[TRACKING]
# 追蹤參數

# 追蹤增益（控制雲台移動的靈敏度）
# 範圍: 0.01-1.0，建議值: 0.15
pan_gain = 0.15
tilt_gain = 0.15

# 無檢測超時時間（秒）
# 連續 N 秒無檢測到目標時，返回監控模式
# 範圍: 0.5-10.0，建議值: 3.0
no_detection_timeout = 3.0

# 目標鎖定距離（像素）
# 多目標時，優先追蹤距離上次位置在此範圍內的目標
# 範圍: 10-500，建議值: 100
target_lock_distance = 100

[HARDWARE]
# 硬體參數

# Arduino 串口設定
# Linux/Orange Pi: /dev/ttyUSB0, /dev/ttyACM0 等
# Windows: COM3, COM4 等
arduino_port = /dev/ttyUSB0

# 雙目攝像頭設備 ID
# 單一雙目攝像頭設備的 ID，系統會自動將其影像分割為左右兩部分
left_camera_id = 0

# Pan 軸舵機 ID（範圍 1-254）
# 控制雲台水平旋轉的舵機識別碼
# 範圍: 1-254，建議值: 1
pan_servo_id = 1

# Tilt 軸舵機 ID（範圍 1-254）
# 控制雲台垂直俯仰的舵機識別碼
# 範圍: 1-254，建議值: 2
tilt_servo_id = 2

[ALERTS]
# 雷射與蜂鳴器控制

# 蜂鳴器冷卻時間（秒），範圍: 0.1-10.0，建議值: 2.0
beep_cooldown = 2.0

# 雷射冷卻時間（秒），範圍: 0.1-5.0，建議值: 0.5
laser_cooldown = 0.5

[SAMPLE_COLLECTION]
# 樣本收集參數

# 是否自動儲存高信心度樣本
save_high_confidence_samples = false

# 是否自動儲存中等信心度樣本
save_uncertain_samples = true

# 中等信心度範圍（用於樣本收集）
# 範圍: 0.0-1.0，建議範圍: 0.4-0.7
uncertain_conf_range_min = 0.4
uncertain_conf_range_max = 0.7

# 最大存儲照片數量（改為數量限制而非磁碟使用率）
# 範圍: 100-10000，建議值: 1000
max_samples = 1000

# 儲存時間間隔（秒）- 避免頻繁存同一位置的照片
# 範圍: 0.1-30.0，建議值: 3.0
save_interval = 3.0

# 是否自動生成 YOLO 格式標註文件 (.txt)
# 啟用後會為每張儲存的照片生成對應的標註文件
# 範圍: true/false，建議值: true
save_annotations = true

# 是否儲存完整畫面或僅裁剪檢測區域
# true: 儲存完整畫面，false: 僅儲存裁剪的檢測區域
# 範圍: true/false，建議值: false
save_full_frame = false

[SAMPLE_ANNOTATION]
# 樣本標註參數

sample_collection_dir = sample_collection
medium_confidence_dir = sample_collection/medium_confidence
high_confidence_dir = sample_collection/high_confidence
confirmed_mosquito_dir = sample_collection/confirmed/mosquito
confirmed_not_mosquito_dir = sample_collection/confirmed/not_mosquito

[SAMPLE_LABELING]
# 樣本標註參數

# 重定位基準目錄（用於樣本整理）
relocation_base_dir = relocated_samples

# 重定位蚊子樣本目錄
relocation_mosquito_dir = relocated_samples/mosquito

# 重定位非蚊子樣本目錄
relocation_not_mosquito_dir = relocated_samples/not_mosquito

# Colab Notebook 目標目錄
colab_notebook_dest_dir = colab_notebooks

[NETWORK]
# 網路配置

# 自動獲取本機 IP 地址（用於生成訪問說明）
# 設為 127.0.0.1 時會自動檢測本機 IP
device_ip = 127.0.0.1

# 外部訪問 URL（透過 Nginx Reverse Proxy）
# 設為空值時不顯示外部 URL
external_url =

[STREAMING_SERVER]
# 串流伺服器參數

# HTTP 串流伺服器端口，範圍: 1024-65535，建議值: 5000
stream_port = 5000

# 串流品質（1-100），範圍: 1-100，建議值: 80
stream_quality = 80

# 串流 FPS，範圍: 1-60，建議值: 15
stream_fps = 15

# RTSP 配置（需外部 MediaMTX 伺服器）
# RTSP 目標地址（0.0.0.0 允許外部訪問）
rtsp_url = rtsp://0.0.0.0:8554/mosquito

# RTSP 視頻碼率 (kbps)，範圍: 500-10000，建議值: 2000
rtsp_bitrate = 2000

# FFmpeg 編碼預設，可選值: ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow
rtsp_preset = ultrafast

[TEMPERATURE_MONITORING]
# 溫度監控參數

# 是否啟用溫度監控
enable_temperature_monitoring = true

# 溫度警告閾值（攝氏度），範圍: 50.0-100.0，建議值: 75.0
temperature_warning_threshold = 75.0

# 溫度暫停閾值（攝氏度）- 超過此溫度將暫停 AI 辨識
# 範圍: 60.0-100.0，建議值: 80.0
temperature_pause_threshold = 80.0

# 溫度恢復閾值（攝氏度）- 降至此溫度以下將恢復 AI 辨識
# 範圍: 50.0-90.0，建議值: 70.0
temperature_resume_threshold = 70.0

# 溫度檢查間隔（秒）- 每分鐘檢查一次以降低系統耗損
# 範圍: 10.0-300.0，建議值: 60.0
temperature_check_interval = 60.0

# 溫度感測器路徑（Linux 系統）
# Orange Pi 5 / RK3588: /sys/class/thermal/thermal_zone0/temp
# Raspberry Pi: /sys/class/thermal/thermal_zone0/temp
temperature_sensor_path = /sys/class/thermal/thermal_zone0/temp

[ILLUMINATION_MONITORING]
# 光照度監控參數

# 是否啟用光照度監控
enable_illumination_monitoring = true

# 光照度警告閾值（亮度值 0-255 範圍）
# 低於此值時在螢幕提示光照不足
# 範圍: 10-200，建議值: 60
illumination_warning_threshold = 60

# 光照度暫停閾值（亮度值 0-255 範圍）
# 低於此值時暫停 AI 辨識，高於此值時恢復 AI 辨識
# 範圍: 5-150，建議值: 40
illumination_pause_threshold = 40

# 光照度檢查間隔（秒）- 每 N 秒檢查一次亮度
# 範圍: 1.0-30.0，建議值: 5.0
illumination_check_interval = 5.0

[CAMERA]
# 攝像頭參數

# ⚠️ 注意：以下常數僅作為向後兼容的預設值
# 系統啟動時會自動檢測並選擇最佳配置，不需要手動修改這些值

# 雙目攝像頭預設設定（單一雙目攝像頭）
# 寬度，範圍: 640-7680 (8K)，建議值: 3840 (4K)
camera_dual_width = 3840

# 高度，範圍: 480-4320 (8K)，建議值: 1080 (雙目模式通常為 2×540)
camera_dual_height = 1080

# FPS，範圍: 1-120，建議值: 60
camera_dual_fps = 60

# 幀延時（秒）- 控制主循環 FPS
# 計算公式: 1/FPS，例如 30 FPS = 0.033 秒
# 範圍: 0.01-1.0，建議值: 0.03
frame_delay = 0.03

[SERIAL]
# 串口參數

# Arduino 串口設定
# 波特率，範圍: 9600-115200，建議值: 115200
arduino_baudrate = 115200

# 超時時間（秒），範圍: 0.1-5.0，建議值: 1.0
arduino_timeout = 1.0

[DEPTH_ESTIMATION]
# 雙目立體匹配參數

# 鏡頭焦距（mm），範圍: 1.0-10.0，建議值: 3.0
depth_focal_length = 3.0

# 雙目基線（mm）- 兩個攝像頭間距，範圍: 10.0-200.0，建議值: 120.0
depth_baseline = 120.0

# 感光元件寬度（mm），範圍: 1.0-100.0，建議值: 5.0
depth_sensor_width = 5.0

[TRACKER]
# 追蹤參數

# 位置更新間隔（秒）
# 減少串口讀取頻率，避免通信阻塞
# 範圍: 0.1-2.0，建議值: 0.5
position_update_interval = 0.5
