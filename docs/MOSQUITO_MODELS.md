# èšŠå­æª¢æ¸¬æ¨¡åž‹æŒçºŒæ”¹é€²æŒ‡å—

æœ¬å°ˆæ¡ˆåœ¨ `models/` ç›®éŒ„å·²æä¾›é è¨“ç·´æ¨¡åž‹ã€‚æœ¬æ–‡æª”èªªæ˜Žå¦‚ä½•åˆ©ç”¨ç³»çµ±è‡ªå‹•æ”¶é›†çš„**ä¸­ä½Žä¿¡å¿ƒåº¦æ¨£æœ¬**é€²è¡Œäººå·¥ç¯©é¸å’Œæ¨¡åž‹å¢žå¼·è¨“ç·´ï¼ŒæŒçºŒæå‡æª¢æ¸¬æº–ç¢ºåº¦ã€‚

##  ç›®éŒ„

- [ç³»çµ±é‹ä½œæµç¨‹](#ç³»çµ±é‹ä½œæµç¨‹)
- [æ¨¡åž‹æ”¹é€²ä¸‰æ­¥é©Ÿ](#æ¨¡åž‹æ”¹é€²ä¸‰æ­¥é©Ÿ)
  - [æ­¥é©Ÿ 1: äººå·¥æ¨™è¨»æ¨£æœ¬](#æ­¥é©Ÿ-1-äººå·¥æ¨™è¨»æ¨£æœ¬)
  - [æ­¥é©Ÿ 2: Google Colab è¨“ç·´](#æ­¥é©Ÿ-2-google-colab-è¨“ç·´)
  - [æ­¥é©Ÿ 3: éƒ¨ç½²æ–°æ¨¡åž‹](#æ­¥é©Ÿ-3-éƒ¨ç½²æ–°æ¨¡åž‹)
- [é æœŸæ”¹é€²æ•ˆæžœ](#é æœŸæ”¹é€²æ•ˆæžœ)
- [æ•…éšœæŽ’é™¤](#æ•…éšœæŽ’é™¤)

---

##  ç³»çµ±é‹ä½œæµç¨‹

### è‡ªå‹•æ¨£æœ¬æ”¶é›†ï¼ˆç³»çµ±å…§å»ºï¼‰

ç³»çµ±åœ¨é‹è¡Œæ™‚æœƒè‡ªå‹•æ”¶é›†**ä¸­ä½Žä¿¡å¿ƒåº¦æª¢æ¸¬æ¨£æœ¬**ï¼Œç”¨æ–¼å¾ŒçºŒäººå·¥å¯©æ ¸å’Œæ¨¡åž‹æ”¹é€²ï¼š

**è§¸ç™¼æ¢ä»¶**ï¼ˆè¦‹ `python/mosquito_tracker.py`ï¼‰ï¼š
```python
# ä¿¡å¿ƒåº¦åœ¨ 0.35-0.65 ä¹‹é–“çš„æª¢æ¸¬æœƒè¢«è‡ªå‹•ä¿å­˜
MEDIUM_CONFIDENCE_MIN = 0.35
MEDIUM_CONFIDENCE_MAX = 0.65
```

**ä¿å­˜ä½ç½®**ï¼š
```
sample_collection/
 medium_confidence/          # ä¸­ç­‰ä¿¡å¿ƒåº¦æ¨£æœ¬ï¼ˆå¾…å¯©æ ¸ï¼‰
    20250127_143022_conf0.42.jpg
    ...
 confirmed/                  # äººå·¥ç¢ºèªå¾Œçš„æ¨£æœ¬ï¼ˆç”¨æ–¼è¨“ç·´ï¼‰
     mosquito/               # ç¢ºèªæ˜¯èšŠå­
     not_mosquito/           # ç¢ºèªä¸æ˜¯èšŠå­ï¼ˆè² æ¨£æœ¬ï¼‰
```

**å»ºè­°æ¨£æœ¬æ•¸é‡**ï¼ˆé–‹å§‹è¨“ç·´å‰ï¼‰ï¼š
- èšŠå­æ¨£æœ¬ï¼šè‡³å°‘ **50-100 å¼µ**
- éžèšŠå­æ¨£æœ¬ï¼šè‡³å°‘ **30-50 å¼µ**ï¼ˆé™ä½Žèª¤å ±çŽ‡ï¼‰

---

##  æ¨¡åž‹æ”¹é€²ä¸‰æ­¥é©Ÿ

### æ­¥é©Ÿ 1: äººå·¥æ¨™è¨»æ¨£æœ¬

ä½¿ç”¨äº’å‹•å¼æ¨™è¨»å·¥å…·å¯©æ ¸æ”¶é›†çš„æ¨£æœ¬ï¼š

```bash
# åœ¨æœ¬åœ°é›»è…¦åŸ·è¡Œ
python python/label_samples.py
```

**åŠŸèƒ½**ï¼š
- è‡ªå‹•é¡¯ç¤ºæ¯å¼µåœ–ç‰‡
- æä¾›äº’å‹•å¼é¸é …ï¼š
  - `y` - ç¢ºèªæ˜¯èšŠå­
  - `n` - ç¢ºèªä¸æ˜¯èšŠå­
  - `d` - åˆªé™¤æ­¤æ¨£æœ¬
  - `s` - ðŸ“Š é¡¯ç¤ºçµ±è¨ˆè³‡è¨Šï¼ˆéš¨æ™‚æŸ¥çœ‹æ¨£æœ¬æ•¸é‡ï¼‰
  - `m` - ðŸ“¦ æ¬é·å·²æ¨™è¨»æ¨£æœ¬ï¼ˆè¨“ç·´å®Œæˆå¾Œæ¸…ç†ç”¨ï¼‰
  - `q` - é€€å‡º
- è‡ªå‹•å°‡æª”æ¡ˆç§»å‹•åˆ°å°æ‡‰ç›®éŒ„

---

### æ­¥é©Ÿ 2: Google Colab è¨“ç·´

**ç‚ºä»€éº¼ä½¿ç”¨ Google Colabï¼Ÿ**
-  **å®Œå…¨å…è²»**ï¼šæ¯æ¬¡å¯ä½¿ç”¨ 12 å°æ™‚ T4 GPU
-  **é€Ÿåº¦å¿«**ï¼šT4 GPU æ¯” Orange Pi 5 CPU å¿« **50-100 å€**
-  **è¨“ç·´æ™‚é–“**ï¼š50 epochs åªéœ€ **15-30 åˆ†é˜**ï¼ˆOrange Pi 5 éœ€ 12-24 å°æ™‚ï¼‰

**æ“ä½œæ­¥é©Ÿ**ï¼š
1. åœ¨ Google Colab é–‹å•Ÿã€Œæˆ‘çš„é›²ç«¯ç¡¬ç¢Ÿ/Colab Notebooks/mosquito_training_colab.ipynbã€
2. é¸æ“‡ GPU åŸ·è¡ŒéšŽæ®µï¼š**åŸ·è¡ŒéšŽæ®µ**  **è®Šæ›´åŸ·è¡ŒéšŽæ®µé¡žåž‹**  **T4 GPU**
3. ä¾åºåŸ·è¡Œæ¯å€‹ Cellï¼ˆå…± 7 å€‹æ­¥é©Ÿï¼‰
4. ç­‰å¾…è¨“ç·´å®Œæˆï¼ˆç´„ 15-30 åˆ†é˜ï¼‰
5. è¨“ç·´å®Œæˆå¾Œï¼Œæ–°æ¨¡åž‹æœƒè‡ªå‹•ä¿å­˜åˆ° Google Drive

**Notebook åŒ…å«çš„æ­¥é©Ÿ**ï¼š
- æŽ›è¼‰ Google Drive
- å®‰è£è¨“ç·´ç’°å¢ƒ
- æº–å‚™æ•¸æ“šé›†ï¼ˆ80/20 åˆ†å‰²ï¼Œé è¨­è‡ªå‹•ä½¿ç”¨ `relocated/` æœ€æ–°ä¸€æ‰¹æ¨£æœ¬ï¼‰
- è¨“ç·´æ¨¡åž‹ï¼ˆ50 epochsï¼‰
- è©•ä¼°çµæžœï¼ˆmAP/ç²¾ç¢ºçŽ‡/å¬å›žçŽ‡ï¼‰
- ä¿å­˜æ¨¡åž‹åˆ° Google Drive
- æŸ¥çœ‹è¨“ç·´æ›²ç·š

---

### æ­¥é©Ÿ 3: éƒ¨ç½²æ–°æ¨¡åž‹

ç­‰å¾… Google Drive æœ¬åœ°åŒæ­¥å®Œæˆå¾Œï¼Œæ ¹æ“šæ‚¨çš„ç¡¬é«”å¹³å°é¸æ“‡å°æ‡‰çš„éƒ¨ç½²æ–¹å¼ï¼š

#### ðŸ”¹ Orange Pi 5ï¼ˆè‡ªå‹•éƒ¨ç½²ï¼‰

åŸ·è¡Œå–®ä¸€ Python è…³æœ¬ï¼ˆè‡ªå‹•å°Žå‡º ONNX èˆ‡ RKNNï¼‰ï¼š

```sh
python python/deploy_model.py
# é è¨­ç›®æ¨™ç”±ç³»çµ±è‡ªå‹•åˆ¤æ–·ï¼ˆLinux éƒ¨ç½²æ©Ÿï¼‰ï¼›å¯è¦†å¯«ï¼š
python python/deploy_model.py --imgsz 640 --rknn-target rk3588
```

#### ðŸ”¹ RDK X5ï¼ˆæ‰‹å‹•è½‰æ›ï¼‰

RDK X5 éœ€è¦é¡å¤–çš„æ‰‹å‹•æ­¥é©Ÿå°‡ ONNX æ¨¡åž‹è½‰æ›ç‚º BIN æ ¼å¼ï¼š

```bash
# 1. é¦–å…ˆå°Žå‡º ONNX æ ¼å¼ï¼ˆåœ¨æœ¬åœ°æˆ– Orange Pi 5ï¼‰
python python/deploy_model.py --skip-rknn

# 2. åœ¨ RDK X5 ä¸Šä½¿ç”¨ hb_mapper è½‰æ›
# åƒè€ƒï¼šhttps://developer.d-robotics.cc/rdk_doc/Quick_start/install_os/
cd /opt/horizon/hb_mapper

# å‰µå»ºé…ç½®æ–‡ä»¶ yolov8_config.yaml
cat > yolov8_config.yaml << EOF
model_parameters:
  onnx_model: 'models/mosquito_yolov8.onnx'
  march: 'bayes-e'
  layer_out_dump: False
  working_dir: 'model_output'
  output_model_file_prefix: 'mosquito_yolov8'
input_parameters:
  input_name: 'images'
  input_type_rt: 'nv12'
  input_layout_rt: 'NHWC'
  input_type_train: 'rgb'
  input_layout_train: 'NCHW'
  norm_type: 'data_scale'
  scale_value: 0.003921568627451
  input_shape: '1x3x640x640'
calibration_parameters:
  cal_data_dir: './calibration_data'
  cal_data_type: 'float32'
  calibration_type: 'default'
compiler_parameters:
  compile_mode: 'latency'
  debug: False
  optimize_level: 'O3'
EOF

# åŸ·è¡Œè½‰æ›
./hb_mapper makertbin --config yolov8_config.yaml

# 3. è¤‡è£½ç”Ÿæˆçš„ BIN æ¨¡åž‹
cp model_output/mosquito_yolov8.bin ~/mosquito-pt2d/models/
```

**éƒ¨ç½²æª¢æŸ¥æ¸…å–®**ï¼š
- [ ] å·²å‚™ä»½èˆŠæ¨¡åž‹
- [ ] æ–°æ¨¡åž‹å·²è¤‡è£½åˆ° `models/` ç›®éŒ„
- [ ] Orange Pi 5: å·²è½‰æ› ONNX + RKNN æ ¼å¼
- [ ] RDK X5: å·²è½‰æ› ONNX + BIN æ ¼å¼
- [ ] æ¸¬è©¦æ–°æ¨¡åž‹æ•ˆæžœ

---

## ðŸ“Š ç¡¬é«”å¹³å°æ¯”è¼ƒ

### æ”¯æ´çš„å¹³å°èˆ‡æ¨¡åž‹æ ¼å¼

| å¹³å° | æŽ¨ç†å¼•æ“Ž | æ¨¡åž‹æ ¼å¼ | ç¡¬é«”åŠ é€Ÿ | å…¸åž‹ FPS (640Ã—640) |
|------|---------|---------|---------|-------------------|
| **RDK X5** | `hobot_dnn` | `.bin` | BPU (Bayes-e, 10 TOPS) | ~30-60 FPS |
| **Orange Pi 5** | `rknnlite` | `.rknn` | NPU (RK3588, 6 TOPS) | ~25-50 FPS |

### RDK X5 å°ˆç”¨é…ç½®

#### å®‰è£ hobot_dnn
```bash
# RDK X5 Ubuntu 20.04
pip3 install hobot_dnn
```

#### é©—è­‰ BPU å¯ç”¨æ€§
```python
import hobot_dnn.pyeasy_dnn as dnn

# è¼‰å…¥æ¨¡åž‹
models = dnn.load("models/mosquito_yolov8.bin")
print(f"è¼¸å…¥æ•¸é‡: {len(models[0].inputs)}")
print(f"è¼¸å‡ºæ•¸é‡: {len(models[0].outputs)}")
```

#### å·²çŸ¥é™åˆ¶
1. **æ¨¡åž‹è½‰æ›**: RDK X5 çš„ BIN æ¨¡åž‹éœ€è¦åœ¨ RDK X5 æœ¬æ©Ÿä½¿ç”¨ `hb_mapper` è½‰æ›
2. **NV12 æ ¼å¼**: BPU åŽŸç”Ÿæ”¯æ´ NV12 è¼¸å…¥æ ¼å¼ï¼Œç³»çµ±è‡ªå‹•è™•ç†è½‰æ›
3. **å·¥å…·éˆ**: éœ€è¦å®‰è£ RDK X5 OpenExplore å·¥å…·éˆ

#### åƒè€ƒè³‡æº
- [RDK X5 å®˜æ–¹æ–‡æª”](https://developer.d-robotics.cc/rdk_doc)
- [hobot_dnn API](https://github.com/D-Robotics/hobot_dnn)
- [YOLO OpenExplore å·¥å…·éˆ](https://github.com/D-Robotics/oe-toolchain)

---

##  å®Œæ•´å·¥ä½œæµç¨‹åœ–

```
Orange Pi 5 / RDK X5 è‡ªå‹•æ”¶é›†æ¨£æœ¬

æœ¬åœ°é›»è…¦: python label_samples.pyï¼ˆæ¨™è¨»ï¼‰

Google Drive æœ¬åœ°åŒæ­¥ï¼ˆä¸Šå‚³æ¨£æœ¬ + æ¨¡åž‹ï¼‰

Google Colab: è¨“ç·´æ¨¡åž‹ï¼ˆ15-30 åˆ†é˜ï¼Œè¼¸å‡º .ptï¼‰

Google Drive æœ¬åœ°åŒæ­¥ï¼ˆä¸‹è¼‰æ–°æ¨¡åž‹ .ptï¼‰

æœ¬åœ°é›»è…¦/å¹³å°ï¼š
â”œâ”€ Orange Pi 5: deploy_model.py â†’ ONNX + RKNNï¼ˆè‡ªå‹•ï¼‰
â””â”€ RDK X5: deploy_model.py â†’ ONNXï¼Œæ‰‹å‹• hb_mapper â†’ BIN

Orange Pi 5 / RDK X5: éƒ¨ç½²æ¸¬è©¦
```

---

##  é æœŸæ”¹é€²æ•ˆæžœ

æ ¹æ“šç¶“é©—ï¼ŒæŒçºŒæ”¹é€²è¨“ç·´å¯å¸¶ä¾†ä»¥ä¸‹æ•ˆæžœï¼š

| è¨“ç·´è¼ªæ¬¡ | æ¨£æœ¬æ•¸ | mAP50 | ç²¾ç¢ºçŽ‡ | å¬å›žçŽ‡ | å‚™è¨» |
|---------|-------|-------|--------|--------|------|
| **åˆå§‹æ¨¡åž‹** | 0 | 0.65 | 0.70 | 0.60 | é è¨“ç·´æ¨¡åž‹ |
| **ç¬¬ 1 è¼ª** | 100 | 0.72 | 0.75 | 0.68 | +7% mAP |
| **ç¬¬ 2 è¼ª** | 200 | 0.78 | 0.80 | 0.75 | +6% mAP |
| **ç¬¬ 3 è¼ª** | 300 | 0.82 | 0.83 | 0.80 | +4% mAP |
| **ç¬¬ 4 è¼ª+** | 500+ | 0.85+ | 0.87+ | 0.83+ | é€æ¼¸é£½å’Œ |

**æ”¹é€²å»ºè­°**ï¼š
- æ¯æ”¶é›† 50-100 å¼µæ–°æ¨£æœ¬å°±é€²è¡Œä¸€æ¬¡è¨“ç·´
- é‡é»žæ”¶é›†**èª¤å ±æ¡ˆä¾‹**ï¼ˆé™ä½Žå‡é™½æ€§ï¼‰
- é—œæ³¨**æ¼æª¢å ´æ™¯**ï¼ˆæé«˜å¬å›žçŽ‡ï¼‰

---

##  æ•…éšœæŽ’é™¤

### Q: Google Colab è¨“ç·´æ™‚è¨˜æ†¶é«”ä¸è¶³ï¼Ÿ
**A**:
```python
# æ¸›å°‘æ‰¹æ¬¡å¤§å°
batch=8  # æˆ–æ›´å°

# é™ä½Žè§£æžåº¦
imgsz=224  # å¾ž 320 é™åˆ° 224
```

### Q: Google Drive åŒæ­¥å¤ªæ…¢ï¼Ÿ
**A**:
1. åªåŒæ­¥å¿…è¦çš„è³‡æ–™å¤¾
2. å£“ç¸®æ¨£æœ¬å¾Œå†ä¸Šå‚³
3. ä½¿ç”¨ rclone ç­‰å·¥å…·åŠ é€ŸåŒæ­¥

### Q: æ–°æ¨¡åž‹æ•ˆæžœåè€Œè®Šå·®ï¼Ÿ
**A**:
1. æª¢æŸ¥æ•¸æ“šé›†å“è³ªï¼ˆæ˜¯å¦æœ‰éŒ¯èª¤æ¨™è¨»ï¼‰
2. å¢žåŠ è¨“ç·´è¼ªæ•¸ï¼ˆepochs=100ï¼‰
3. èª¿æ•´å­¸ç¿’çŽ‡ï¼ˆlr0=0.0001 æ›´å°ï¼‰
4. ä½¿ç”¨æ—©åœï¼ˆpatience=10ï¼‰

### Q: æ‰¾ä¸åˆ° CUDA è£ç½®ï¼Ÿ
**A**:
ç¢ºèª Colab å·²é¸æ“‡ GPU åŸ·è¡ŒéšŽæ®µï¼š
- é»žæ“Šã€ŒåŸ·è¡ŒéšŽæ®µã€ã€Œè®Šæ›´åŸ·è¡ŒéšŽæ®µé¡žåž‹ã€
- é¸æ“‡ã€ŒT4 GPUã€æˆ–ã€ŒV100 GPUã€

---

##  åƒè€ƒè³‡æº

- [Google Colab å®˜æ–¹æ–‡æª”](https://colab.research.google.com/)
- [Ultralytics YOLOv8 æ–‡æª”](https://docs.ultralytics.com/)
- [Google Drive åŒæ­¥è¨­å®š](https://support.google.com/drive/answer/2374987)

---

**æœ€å¾Œæ›´æ–°**: 2025å¹´12æœˆ27æ—¥